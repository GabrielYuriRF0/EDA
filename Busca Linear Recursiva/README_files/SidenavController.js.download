app.controller('SidenavController', function ($scope, $timeout, $mdSidenav, $state, SessionService, $http, $q) {
    
    var self = this;

    self.goToHome = function() {
        $state.go('app.home');
    };

    self.goToInstructions = function() {
        $state.go('app.instructions');
    };

    self.goToAnalytics = function() {
        $state.go('app.analytics');
    };

    self.setStats = function() {

        var q = $q.defer();
		var url = "http://api-tst-eda.splab.ufcg.edu.br/user/" + self.userEmail;

		$http.get(url).then( function(info) {
			self.done = info.data['done'];
			self.fail = info.data['fail'];
			self.never = info.data['never_tried'];
            q.resolve(info.data);
		});

        return q.promise;
    };

    (function main() {
        self.user = SessionService.getUser();
        self.userEmail = SessionService.userEmail;
        self.setStats();
    })();

});