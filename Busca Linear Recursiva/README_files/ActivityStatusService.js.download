app.service("ActivityStatusService", ["$http", "$cookies", "$q", "SessionService", function($http, $cookies, $q, SessionService) {

    var self = this;

    self.status = {};

    self.loadSubmissions = function () {

        var q = $q.defer();
        var user_email = SessionService.userEmail;
        var my_submissions = "http://api-tst-eda.splab.ufcg.edu.br/user/" + user_email;
        
        $http.get(my_submissions).then(function (info) {

            var tried = info.data.tried;
            self.tried = info.data.tried;

            var done = info.data.done;
            self.tried = tried;

            for (i in tried) {
                var act_name = tried[i];
                self.status[act_name] = 0;
            }

            for (i in done) {
                var act_name = done[i];
                self.status[act_name] = 1;
            }

            q.resolve(info.data);
        }, function (info) {

        });

        return q.promise;
    };
    
    self.getActivityStatus = function(act_name) {
        return self.status[act_name];
    };

    (function main() {
        self.loadSubmissions();
    })();

}]);